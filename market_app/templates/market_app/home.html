<!doctype html>
<html lang="en" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Baylor Marketplace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body {
        background-color: #020810;
        background-image:
          radial-gradient(ellipse 120% 70% at 50% -5%, rgba(16, 185, 129, 0.26) 0%, transparent 80%),
          radial-gradient(ellipse 70% 50% at 85% 55%, rgba(5, 150, 105, 0.14) 0%, transparent 70%),
          radial-gradient(ellipse 60% 40% at 5% 85%, rgba(16, 185, 129, 0.11) 0%, transparent 65%),
          radial-gradient(ellipse 40% 30% at 50% 100%, rgba(52, 211, 153, 0.07) 0%, transparent 60%);
      }

      /* Subtle animated grid */
      .grid-bg {
        background-image:
          linear-gradient(rgba(16,185,129,0.04) 1px, transparent 1px),
          linear-gradient(90deg, rgba(16,185,129,0.04) 1px, transparent 1px);
        background-size: 60px 60px;
      }

      @keyframes fadeUp {
        from { opacity: 0; transform: translateY(20px); }
        to   { opacity: 1; transform: translateY(0); }
      }
      @keyframes pulse-glow {
        0%, 100% { box-shadow: 0 0 20px rgba(16,185,129,0.3), 0 0 40px rgba(16,185,129,0.1); }
        50%       { box-shadow: 0 0 30px rgba(16,185,129,0.5), 0 0 60px rgba(16,185,129,0.2); }
      }
      @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50%       { transform: translateY(-8px); }
      }
      @keyframes shimmer {
        0%   { background-position: -200% center; }
        100% { background-position: 200% center; }
      }

      .fade-up   { animation: fadeUp 0.6s ease both; }
      .fade-up-1 { animation-delay: 0.05s; }
      .fade-up-2 { animation-delay: 0.2s; }
      .fade-up-3 { animation-delay: 0.35s; }

      .user-dropdown { position: relative; display: inline-block; }
      .dropdown-menu {
        display: none;
        position: absolute;
        right: 0;
        top: calc(100% + 8px);
        min-width: 160px;
        background: rgba(5, 12, 24, 0.95);
        border: 1px solid rgba(16,185,129,0.2);
        border-radius: 12px;
        backdrop-filter: blur(20px);
        box-shadow: 0 16px 40px rgba(0,0,0,0.5), 0 0 0 1px rgba(16,185,129,0.08);
        overflow: hidden;
        z-index: 50;
        animation: fadeUp 0.15s ease both;
      }
      .user-dropdown:hover .dropdown-menu,
      .user-dropdown:focus-within .dropdown-menu { display: block; }
      .dropdown-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 14px;
        font-size: 0.8125rem;
        color: #d1d5db;
        text-decoration: none;
        transition: background 0.15s, color 0.15s;
        cursor: pointer;
      }
      .dropdown-item:hover { background: rgba(16,185,129,0.08); color: #fff; }
      .dropdown-item.danger { color: #f87171; }
      .dropdown-item.danger:hover { background: rgba(239,68,68,0.08); color: #fca5a5; }
      .dropdown-divider { height: 1px; background: rgba(255,255,255,0.06); margin: 2px 0; }
      .username-btn {
        display: flex;
        align-items: center;
        gap: 5px;
        color: #d1d5db;
        font-size: 0.875rem;
        cursor: pointer;
        padding: 4px 8px;
        border-radius: 8px;
        transition: background 0.2s, color 0.2s;
        border: none;
        background: transparent;
      }
      .username-btn:hover { background: rgba(255,255,255,0.05); color: #fff; }
        position: relative;
        background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
        transition: all 0.3s ease;
        overflow: hidden;
      }
      .btn-primary::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6ee7b7 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
      }
      .btn-primary:hover::before { opacity: 1; }
      .btn-primary:hover { animation: pulse-glow 1.5s ease-in-out infinite; transform: translateY(-1px); }
      .btn-primary span { position: relative; z-index: 1; }

      .btn-secondary {
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(16,185,129,0.3);
        transition: all 0.3s ease;
        backdrop-filter: blur(8px);
      }
      .btn-secondary:hover {
        background: rgba(16,185,129,0.1);
        border-color: rgba(16,185,129,0.6);
        box-shadow: 0 0 20px rgba(16,185,129,0.15), inset 0 0 20px rgba(16,185,129,0.05);
        transform: translateY(-1px);
      }

      .hero-badge {
        background: linear-gradient(135deg, rgba(16,185,129,0.15), rgba(52,211,153,0.08));
        border: 1px solid rgba(16,185,129,0.25);
        backdrop-filter: blur(8px);
      }

      .gradient-text {
        background: linear-gradient(135deg, #34d399 0%, #10b981 40%, #6ee7b7 100%);
        background-size: 200% auto;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: shimmer 4s linear infinite;
      }

      .card-glow {
        background: rgba(255,255,255,0.02);
        border: 1px solid rgba(255,255,255,0.06);
        backdrop-filter: blur(12px);
        transition: all 0.3s ease;
      }
      .card-glow:hover {
        border-color: rgba(16,185,129,0.35);
        background: rgba(16,185,129,0.04);
        box-shadow: 0 8px 32px rgba(16,185,129,0.1), 0 0 0 1px rgba(16,185,129,0.1);
        transform: translateY(-2px);
      }
      .card-img { transition: transform 0.4s ease; }
      .product-card:hover .card-img { transform: scale(1.05); }

      .stat-pill {
        background: rgba(16,185,129,0.08);
        border: 1px solid rgba(16,185,129,0.2);
      }

      /* Orb decorations */
      .orb {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px);
        pointer-events: none;
        z-index: 0;
      }

      /* Welcome overlay */
      .card-welcome {
        background: rgba(5, 14, 28, 0.96);
        border: 1px solid rgba(16,185,129,0.25);
        backdrop-filter: blur(24px);
        box-shadow: 0 0 0 1px rgba(16,185,129,0.08), 0 40px 80px rgba(0,0,0,0.6), 0 0 60px rgba(16,185,129,0.12);
        animation: overlayIn 0.35s cubic-bezier(0.34,1.56,0.64,1) both;
      }
      @keyframes overlayIn {
        from { opacity: 0; transform: scale(0.88) translateY(16px); }
        to   { opacity: 1; transform: scale(1) translateY(0); }
      }
      .check-circle {
        background: radial-gradient(circle, rgba(16,185,129,0.2) 0%, rgba(16,185,129,0.05) 70%);
        border: 1.5px solid rgba(16,185,129,0.3);
        animation: pulse-glow 2s ease-in-out infinite;
      }
      .check-draw {
        stroke-dasharray: 30;
        stroke-dashoffset: 30;
        animation: drawCheck 0.5s ease 0.3s forwards;
      }
      @keyframes drawCheck {
        to { stroke-dashoffset: 0; }
      }
    </style>
  </head>
  <body class="min-h-full text-gray-100 antialiased grid-bg">
    <!-- Decorative orbs -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
      <div
        class="orb w-96 h-96 bg-emerald-500/10 top-[-8rem] left-1/2 -translate-x-1/2"
      ></div>
      <div class="orb w-64 h-64 bg-green-400/8 bottom-1/3 right-[-4rem]"></div>
      <div class="orb w-48 h-48 bg-teal-500/8 top-1/2 left-[-3rem]"></div>
    </div>

    <!-- Nav -->
    <header
      class="border-b border-white/[0.06] bg-black/40 backdrop-blur-xl sticky top-0 z-10"
    >
      <div
        class="max-w-6xl mx-auto px-6 h-14 flex items-center justify-between"
      >
        <a
          href="{% url 'home' %}"
          class="font-bold tracking-tight text-white flex items-center gap-2"
        >
          <span
            class="w-6 h-6 rounded bg-gradient-to-br from-emerald-400 to-green-600 flex items-center justify-center text-xs font-black text-white"
            >B</span
          >
          Baylor Marketplace
        </a>
        <nav class="flex items-center gap-5 text-sm text-gray-400">
          <a
            href="{% url 'browse' %}"
            class="hover:text-white transition-colors"
            >Browse</a
          >
          {% if user.is_authenticated %}
          <a
            href="{% url 'view_products' %}"
            class="hover:text-white transition-colors"
            >My Listings</a
          >
          <span class="text-gray-700">|</span>
          <div class="user-dropdown">
            <button class="username-btn">
              {{ user.username }}
              <svg
                class="w-3 h-3 opacity-50"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2.5"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>
            <div class="dropdown-menu">
              <div class="px-3 py-2.5 border-b border-white/[0.06]">
                <p class="text-xs text-gray-500">Signed in as</p>
                <div class="flex items-center gap-2 mt-0.5">
                  <p class="text-sm font-semibold text-white truncate">
                    {{ user.username }}
                  </p>
                  {% if user.is_staff %}<span
                    class="inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide bg-amber-500/15 text-amber-400 border border-amber-500/25"
                    >âš¡ Staff</span
                  >{% endif %}
                </div>
              </div>
              <a href="{% url 'settings_page' %}" class="dropdown-item">
                <svg
                  class="w-3.5 h-3.5 opacity-60"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
                  />
                  <circle cx="12" cy="12" r="3" />
                </svg>
                Settings
              </a>
              <div class="dropdown-divider"></div>
              <a href="{% url 'logout' %}" class="dropdown-item danger">
                <svg
                  class="w-3.5 h-3.5 opacity-70"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                  />
                </svg>
                Sign out
              </a>
            </div>
          </div>
          <a
            href="{% url 'create_product' %}"
            class="btn-primary px-3 py-1.5 rounded-lg text-white text-sm font-semibold"
            ><span>+ List Item</span></a
          >
          {% else %}
          <a
            href="{% url 'login_page' %}"
            class="hover:text-white transition-colors"
            >Log in</a
          >
          <a
            href="{% url 'signup_page' %}"
            class="btn-primary px-3 py-1.5 rounded-lg text-white text-sm font-semibold"
            ><span>Sign up</span></a
          >
          {% endif %}
        </nav>
      </div>
    </header>

    <!-- Hero -->
    <section
      class="relative max-w-6xl mx-auto px-6 pt-24 pb-20 text-center fade-up fade-up-1 z-[1]"
    >
      <div
        class="inline-flex items-center gap-2 hero-badge rounded-full px-4 py-1.5 text-xs font-medium text-emerald-400 tracking-widest uppercase mb-6"
      >
        <span
          class="w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"
        ></span>
        Baylor University
      </div>

      <h1
        class="text-5xl sm:text-6xl font-extrabold leading-[1.1] mb-6 tracking-tight"
      >
        The student marketplace<br />
        <span class="gradient-text">built for Baylor.</span>
      </h1>

      <p class="text-gray-400 text-lg mb-10 max-w-lg mx-auto leading-relaxed">
        Textbooks, dorm essentials, electronics â€” listed by students, trusted by
        the community.
      </p>

      {% if not user.is_authenticated %}
      <!-- Auth CTA buttons -->
      <div class="flex justify-center gap-4 flex-wrap mb-6">
        <a
          href="{% url 'signup_page' %}"
          class="btn-primary inline-flex items-center gap-2 px-7 py-3 rounded-xl text-white font-semibold text-base shadow-lg shadow-emerald-900/40"
        >
          <span>Create Account</span>
          <svg
            class="w-4 h-4 relative z-10"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M13 7l5 5m0 0l-5 5m5-5H6"
            />
          </svg>
        </a>
        <a
          href="{% url 'login_page' %}"
          class="btn-secondary inline-flex items-center gap-2 px-7 py-3 rounded-xl text-white font-semibold text-base"
        >
          Log In
        </a>
      </div>
      <p class="text-xs text-gray-600 mb-4">Free to join Â· BU students only</p>
      {% endif %}

      <div class="flex justify-center gap-3 flex-wrap mt-2">
        <a
          href="{% url 'browse' %}"
          class="inline-flex items-center gap-1.5 text-sm text-emerald-400 hover:text-emerald-300 transition-colors font-medium"
        >
          Browse listings
          <svg
            class="w-3.5 h-3.5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M13 7l5 5m0 0l-5 5m5-5H6"
            />
          </svg>
        </a>
      </div>

      {% if total_listings %}
      <div
        class="mt-8 inline-flex items-center gap-2 stat-pill rounded-full px-4 py-1.5 text-xs text-gray-400"
      >
        <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
        {{ total_listings }} active listing{{ total_listings|pluralize }} right
        now
      </div>
      {% endif %}
    </section>

    <!-- Feature highlights -->
    {% if not user.is_authenticated %}
    <section
      class="relative max-w-6xl mx-auto px-6 pb-16 fade-up fade-up-2 z-[1]"
    >
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
        <div class="card-glow rounded-2xl p-6 text-center">
          <h3 class="text-white font-semibold mb-1">Textbooks</h3>
          <p class="text-gray-500 text-sm">Save hundreds on course materials every semester.</p>
        </div>
        <div class="card-glow rounded-2xl p-6 text-center">
          <h3 class="text-white font-semibold mb-1">Dorm Essentials</h3>
          <p class="text-gray-500 text-sm">Furnish your space without breaking the bank.</p>
        </div>
        <div class="card-glow rounded-2xl p-6 text-center">
          <h3 class="text-white font-semibold mb-1">Electronics</h3>
          <p class="text-gray-500 text-sm">Laptops, calculators, gear from fellow Bears.</p>
        </div>
      </div>
    </section>
    {% endif %}
  {% for message in messages %}{% if message.message == 'welcome_new_user' %}
    <!-- Welcome overlay -->
    <div
      id="welcome-overlay"
      class="fixed inset-0 z-50 flex items-center justify-center p-6"
    >
      <!-- Backdrop -->
      <div
        class="absolute inset-0 bg-black/70 backdrop-blur-sm"
        onclick="closeWelcome()"
      ></div>
      <!-- Card -->
      <div
        class="relative card-welcome rounded-3xl p-10 max-w-sm w-full text-center shadow-2xl"
      >
        <!-- Close button -->
        <button
          onclick="closeWelcome()"
          class="absolute top-4 right-4 w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:text-white hover:bg-white/10 transition-all"
        >
          <svg
            class="w-4 h-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M6 18L18 6M6 6l12 12"
            />
          </svg>
        </button>
        <!-- Checkmark -->
        <div
          class="check-circle w-20 h-20 rounded-full mx-auto mb-6 flex items-center justify-center"
        >
          <svg
            class="w-10 h-10 text-emerald-400 check-draw"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M5 13l4 4L19 7"
            />
          </svg>
        </div>
        <h2 class="text-2xl font-extrabold text-white mb-2">You're in! ðŸŽ‰</h2>
        <p class="text-gray-400 text-sm leading-relaxed mb-8">
          Welcome to Baylor Marketplace. Browse listings, post items for sale,
          and connect with fellow Bears.
        </p>
        <button
          onclick="closeWelcome()"
          class="btn-primary w-full py-3 rounded-xl text-white font-semibold text-base"
        >
          <span>Explore the marketplace</span>
        </button>
        <p class="mt-4 text-xs text-gray-600">
          You can log in at any time from the nav.
        </p>
      </div>
    </div>
    {% endif %}{% endfor %}

    <script>
      function closeWelcome() {
        const overlay = document.getElementById("welcome-overlay");
        if (overlay) {
          overlay.style.transition = "opacity 0.25s ease";
          overlay.style.opacity = "0";
          setTimeout(() => overlay.remove(), 250);
        }
      }
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeWelcome();
      });
    </script>
  </body>
</html>
